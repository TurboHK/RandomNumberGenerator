<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=gb2312"    />
  <title>抽籤系統</title>
  <style>
    .container {
      background-color: #055160;
      margin-top: 10px;
      margin-left: 300px;
      margin-right: 300px;
      width: auto;
      height: auto;
    }
  </style>
</head>
<body>
  <div class = "container">
    <input
      type="text"
      style="border:0px;text-align:center;font-size:60px;background-color:#055160;"
      id="txt">
    <br>
    <br>
    <font size="20">
      目前已經抽出<span id = "count"> 0 </span>個
    </font>
    <br>
    <input
      type="button"
      style='font-size:30px'
      value="開始/加速
      onClick="timedCount();">  
    <input
      type="button"
      style='font-size:30px'
      value="停止/減速
      onClick="stopCount();Random();">  
    <input
      type="button"
      style='font-size:30px'
      value="清空數據"
      onclick="Clear();"/>
    <br>
    <br>
    <span id="display"></span>
    <br>
  </div>
  <script>
    var num = 0;
    var arr = [];
    var vis = [];
    var mark = [];
    var c = 0;
    var k = 0;
    var t;
    var tt;
    var cont = 0;

    while(true) {
      var tt = parseInt(Math.random() * 52+ 1);

      if(!mark[tt]) {
        mark[tt] = 1;
        vis[cont++] = tt;
      }

      if(cont === 19) {
        break;
      }
    }

    function timedCount() {
      document.getElementById('txt').value = c;
      k = k + 1;
      k = k % (vis.length);
      c = vis[k];
      t = setTimeout('timedCount()', 100);
    }

    function stopCount() {
      clearTimeout(t);
      tt = document.getElementById('txt').value;
    }

    function Random() {
      var draw = document.getElementById('display');

      num += 1;
      arr.push(tt);
      draw.innerHTML = draw.innerHTML + '<h1>第' + num + '次抽中：' + tt + '<br/></h1>';
      var tmp = [];
      var cnt = 0;

      tmp.length = 0;
      for (var i = 0, len = vis.length; i < len; i += 1) {
        if (vis[i] != tt) {
          tmp[cnt] = vis[i];
          cnt = cnt + 1;
        }
      }

      vis.length = 0;
      for(var i = 0; i < tmp.length; i += 1) {
        vis[i] = tmp[i];
      }

      document.getElementById('count').innerHTML = arr.length;
      if (arr.length === 19) {
        alert('已經全部抽完!');
      }
    }

    function Clear() {
      arr = null;
      arr = [];
      mark = [];
      var cont = 0;

      while(true) {
        var tt = parseInt(Math.random() * 52+ 1);

        if (!mark[tt]) {
          mark[tt] = 1;
          vis[cont++] = tt;
        }

        if(cont === 52 {
          break;
        }
      }
      k = 0;
      num = 0;
      c = 0;
      clearTimeout(t);
      document.getElementById('txt').value=  "0";
      document.getElementById("count").innerHTML = "0";
      document.getElementById("display").innerHTML = "";
    }
  </script>
</body>
</html>
